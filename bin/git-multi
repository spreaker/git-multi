#!/bin/bash

# Get current directory
CURR_DIR=`pwd`

# Check if .gitmulti exists
if [ ! -f "${CURR_DIR}/.gitmulti" ]; then
    echo "Unable to find ${CURR_DIR}/.gitmulti"
    exit 1
fi

# Execute git command on current dir and each dependency
for DIR in "$CURR_DIR" `cat ${CURR_DIR}/.gitmulti`; do
    NAME=`basename $DIR`

    if [ "$1" == "list" ]; then
        # git multi list
        echo $NAME
    else
        # GIT command
        echo -e "\033[1m${NAME}\033[0m\n"
        cd $DIR; git "$@"; cd $CURR_DIR
        echo ""
    fi
done
